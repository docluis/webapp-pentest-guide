# webapp-pentest-guide  

# 1 Determining Scope & Enumeration

## Fuzzing Endpoints

```shell
ffuf -u "<URL>" -H "Host:FUZZ.<DOMAIN>" -w <WORDLIST> //virtual hosts
ffuf -u "http<s>://FUZZ.<DOMAIN>" -w <WORDLIST> //sub domains
gobuster dir -u <URL> -w <WORDLIST> //find pages/endpoints
```
## Enumeration Tools

- Wappalyzer  
- WP Scan  

> Goal is getting an overview of all endpoints within scope of testing specified in the contract / bounty program. First attack vectors can be defined from that.

# 2 Understanding Functionality

Start by testing the website the intended way:  
- look for potential attack vectors and crutial endpoints
- note unexpected behavior (like error logs exposed to the user)
- Identify the different priviledge classes (unauthenticated, regular user, manager, admin, ...)
- check cookies set when using

> Use the understanding of functionality to find further potential attack vectors and to plan the testing process.

# 3 Testing

Look for Input in URL parameters or request bodies.

## Insecure Object Domain Reference (IDOR) / Broken Access Control
> wip: Access to Sensitive Data -> Log Poisoning -> XSS
## Cross Site Request Forgery (CSRF)
## Server Side Request Forgery (SSRF)
## Cross Site Scripting (XXS)
## Template Injection
## (No)SQL Injection
## XML External Entity (XXE)
## Race Conditions
## Weak Credentials
</br></br>
# 4 Additional Simple Testing

## Outdated Software

Wappalyzer can display software versions. Alternativley reverse google-image search logo of the software (if found). Or view source to find version.

> Potential Impact:  
> - **RCE** depending on vunlnerability
> - **Leverage** to other vulnerability

## Subdomain Takeover

Check for unclaimed DNS entries.
```shell
python3 /opt/knock/knock.py <DOMAIN>
```
> Potential Impact:  
> - **Login Phishing** on official looking URL
> - **Leverage** to other vulnerability

## Weak Ciphers (HTTPS)

Check for unsecure cyphers supported by the app. Nmap grades the ciphers, anything less than C is a finding.  
```shell
nmap -p443 --script ssl-enum-ciphers <URL/IP>
```
> Potential Impact:  
> - Attacker could **decript HTTPS traffic** and extract sensitive data (e.g. session cookies)

# 5 Resources

Blablablablabla, bla
