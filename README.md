# webapp-pentest-guide  

# 1 Determining Scope & Enumeration

## Fuzzing Endpoints

```shell
gobuster vhost -u <URL> -w <WORDLIST> //virtual hosts
ffuf -u "http<s>://FUZZ.<DOMAIN>" -w <WORDLIST> //sub domains
gobuster dir -u <URL> -w <WORDLIST> //find pages/endpoints
```
## Enumeration Tools

- Wappalyzer  
- WP Scan  

> Goal is getting an overview of all endpoints within scope of testing specified in the contract / bounty program. First attack vectors can be defined from that.

# 2 Understanding Functionality

Start by testing the website the intended way:  
- look for potential attack vectors and crutial endpoints
- note unexpected behavior (like error logs exposed to the user)
- Identify the different priviledge classes (unauthenticated, regular user, manager, admin, ...)
- check cookies set when using

> Use the understanding of functionality to find further potential attack vectors and to plan the testing process.

# 3 Testing

Look for Input in URL parameters or request bodies.

## Insecure Authentication
### Verbose Failure Messages
Submit valid and invald usernames in Login, Registration, Password Change/Password Forgotten. Note if response / response-size are different
> Verbose failure messages can lead to user ennumeration and other information disclosure.
### Forgotten Password Page
Understand procedure with controlled account. Take note if application uses a challenge or unique URL via email to ensure authenticity.
> Challenges are potentially bruteforceable, URL can be predictable or reusable.
### Remember Me
If application has a remember me functionality, inspect cookies for how user is remembered. Review encoded and obfuscaed data for potential flaws.
> If implemented wrong, this could allow an attacker to login as someone else.
### Log In As Someone Else
See if you can use Impersonation feature to log in as someone else with higher priviledges.
> Users should not be allowed to login as someone with higher priviledges
### Fail-Open
Test login with valid account multiple times, modifying the request each time a little bit:
* Submit empty strings as value
* Remove name/password pair
* Submit very long and short values
* Submit strings instead of numbers (and other way around)
* ...
> Sometimes errors can still lead to successful logins
### Weak Credentials
Try default credentials or bruteforce
### Multifacor Authentication
Keep track of complete Authentication Process.
* In some cases, the authentication does not rely on all stages and certain parts can be skipped by directly navigating to the user-page (or whatever comes after login) after only completing the first stage(s)
* When the same data is resubmitted in multiple stages, try using a controlled user's data to authenticate as another (uncontrolled) user.
* Take note of data set by the application (like `stage2complete=true`)
### OAuth Authentication
> wip: OAuth Stuff
## Insecure Object Domain Reference (IDOR) / Broken Access Control
> wip: Access to Sensitive Data -> Log Poisoning -> XSS
## Cross Site Request Forgery (CSRF)
## Server Side Request Forgery (SSRF)
## Cross Site Scripting (XXS)
## Template Injection
## (No)SQL Injection
## XML External Entity (XXE)
## Race Conditions
## Weak Credentials
## Logic/Configuration Vulnerabilities
</br></br>
# 4 Additional Simple Testing

## Outdated Software

Wappalyzer can display software versions. Alternativley reverse google-image search logo of the software (if found). Or view source to find version.

> Potential Impact:  
> - **RCE** depending on vunlnerability
> - **Leverage** to other vulnerability

## Subdomain Takeover

Check for unclaimed DNS entries.
```shell
python3 /opt/knock/knock.py <DOMAIN>
```
> Potential Impact:  
> - **Login Phishing** on official looking URL
> - **Leverage** to other vulnerability

## Weak Ciphers (HTTPS)

Check for unsecure cyphers supported by the app. Nmap grades the ciphers, anything less than C is a finding.  
```shell
nmap -p443 --script ssl-enum-ciphers <URL/IP>
```
> Potential Impact:  
> - Attacker could **decript HTTPS traffic** and extract sensitive data (e.g. session cookies)

# 5 Resources

Blablablablabla, bla
